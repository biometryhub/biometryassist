<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform Multiple Comparison Tests on a statistical model — multiple_comparisons • biometryassist</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Multiple Comparison Tests on a statistical model — multiple_comparisons"><meta name="description" content="A function for comparing and ranking predicted means with Tukey's Honest Significant Difference (HSD) Test."><meta property="og:description" content="A function for comparing and ranking predicted means with Tukey's Honest Significant Difference (HSD) Test."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-971LPN0BS4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-971LPN0BS4');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biometryassist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/installing-asreml-r.html">Installing ASReml-R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biometryhub/biometryassist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform Multiple Comparison Tests on a statistical model</h1>
      <small class="dont-index">Source: <a href="https://github.com/biometryhub/biometryassist/blob/main/R/mct.R" class="external-link"><code>R/mct.R</code></a></small>
      <div class="d-none name"><code>multiple_comparisons.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function for comparing and ranking predicted means with Tukey's Honest Significant Difference (HSD) Test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiple_comparisons</span><span class="op">(</span></span>
<span>  <span class="va">model.obj</span>,</span>
<span>  <span class="va">classify</span>,</span>
<span>  sig <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  int.type <span class="op">=</span> <span class="st">"ci"</span>,</span>
<span>  trans <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  decimals <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  descending <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  label_height <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  rotation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  savename <span class="op">=</span> <span class="st">"predicted_values"</span>,</span>
<span>  <span class="va">order</span>,</span>
<span>  <span class="va">pred.obj</span>,</span>
<span>  <span class="va">pred</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-obj">model.obj<a class="anchor" aria-label="anchor" href="#arg-model-obj"></a></dt>
<dd><p>An ASReml-R or aov model object. Will likely also work with <code>lme</code> (<code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">nlme::lme()</a></code>), <code>lmerMod</code> (<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code>) models as well.</p></dd>


<dt id="arg-classify">classify<a class="anchor" aria-label="anchor" href="#arg-classify"></a></dt>
<dd><p>Name of predictor variable as string.</p></dd>


<dt id="arg-sig">sig<a class="anchor" aria-label="anchor" href="#arg-sig"></a></dt>
<dd><p>The significance level, numeric between 0 and 1. Default is 0.05.</p></dd>


<dt id="arg-int-type">int.type<a class="anchor" aria-label="anchor" href="#arg-int-type"></a></dt>
<dd><p>The type of confidence interval to calculate. One of <code>ci</code>, <code>tukey</code>, <code>1se</code> or <code>2se</code>. Default is <code>ci</code>.</p></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p>Transformation that was applied to the response variable. One of <code>log</code>, <code>sqrt</code>, <code>logit</code>, <code>power</code> or <code>inverse</code>. Default is <code>NULL</code>.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>Numeric offset applied to response variable prior to transformation. Default is <code>NULL</code>. Use 0 if no offset was applied to the transformed data. See Details for more information.</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Numeric power applied to response variable with power transformation. Default is <code>NULL</code>. See Details for more information.</p></dd>


<dt id="arg-decimals">decimals<a class="anchor" aria-label="anchor" href="#arg-decimals"></a></dt>
<dd><p>Controls rounding of decimal places in output. Default is 2 decimal places.</p></dd>


<dt id="arg-descending">descending<a class="anchor" aria-label="anchor" href="#arg-descending"></a></dt>
<dd><p>Logical (default <code>FALSE</code>). Order of the output sorted by the predicted value. If <code>TRUE</code>, largest will be first, through to smallest last.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>Logical (default <code>TRUE</code>). If <code>TRUE</code>, the significance letter groupings will be calculated and displayed. This can get overwhelming for large numbers of comparisons, so can be turned off by setting to <code>FALSE</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Automatically produce a plot of the output of the multiple comparison test? Default is <code>FALSE</code>. This is maintained for backwards compatibility, but the preferred method now is to use <code>autoplot(&lt;multiple_comparisons output&gt;)</code>. See <code><a href="autoplot.html">autoplot.mct()</a></code> for more details.</p></dd>


<dt id="arg-label-height">label_height<a class="anchor" aria-label="anchor" href="#arg-label-height"></a></dt>
<dd><p>Height of the text labels above the upper error bar on the plot. Default is 0.1 (10%) of the difference between upper and lower error bars above the top error bar.</p></dd>


<dt id="arg-rotation">rotation<a class="anchor" aria-label="anchor" href="#arg-rotation"></a></dt>
<dd><p>Rotate the text output as Treatments within the plot. Allows for easier reading of long treatment labels. Number between 0 and 360 (inclusive) - default 0</p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>Logical (default <code>FALSE</code>). Save the predicted values to a csv file?</p></dd>


<dt id="arg-savename">savename<a class="anchor" aria-label="anchor" href="#arg-savename"></a></dt>
<dd><p>A file name for the predicted values to be saved to. Default is <code>predicted_values</code>.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>Deprecated. Use <code>descending</code> instead.</p></dd>


<dt id="arg-pred-obj">pred.obj<a class="anchor" aria-label="anchor" href="#arg-pred-obj"></a></dt>
<dd><p>Deprecated. Predicted values are calculated within the function from version 1.0.1 onwards.</p></dd>


<dt id="arg-pred">pred<a class="anchor" aria-label="anchor" href="#arg-pred"></a></dt>
<dd><p>Deprecated. Use <code>classify</code> instead.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed through to <code><a href="predictions.html">get_predictions()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing a data frame with predicted means, standard errors,
confidence interval upper and lower bounds, and significant group
allocations (named <code>predicted_values</code>), as well as a plot visually
displaying the predicted values (named <code>predicted_plot</code>). If some of the
predicted values are aliased, a warning is printed, and the aliased
treatment levels are returned in the output (named <code>aliased</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="offset">Offset<a class="anchor" aria-label="anchor" href="#offset"></a></h3>


<p>Some transformations require that data has a small offset to be
applied, otherwise it will cause errors (for example taking a log of 0, or
the square root of negative values). In order to correctly reverse this
offset, if the <code>trans</code> argument is supplied, a value should also be supplied
in the <code>offset</code> argument. By default the function assumes no offset was
required for a transformation, implying a value of 0 for the <code>offset</code>
argument. If an offset value is provided, use the same value as provided in
the model, not the inverse. For example, if adding 0.1 to values for a log
transformation, add 0.1 in the <code>offset</code> argument.</p>
</div>

<div class="section">
<h3 id="power">Power<a class="anchor" aria-label="anchor" href="#power"></a></h3>


<p>The power argument allows the specification of arbitrary powers to be
back transformed, if they have been used to attempt to improve normality of
residuals.</p>
<p>#' ## Confidence Intervals &amp; Comparison Intervals</p>
<p>The function provides several options for confidence intervals via the <code>int.type</code> argument:</p><ul><li><p><strong><code>tukey</code> (default)</strong>: Tukey comparison intervals that are consistent with the multiple comparison test. These intervals are wider than regular confidence intervals and are designed so that non-overlapping intervals correspond to statistically significant differences in the Tukey HSD test. This ensures visual consistency between the intervals and letter groupings.</p></li>
<li><p><strong><code>ci</code></strong>: Traditional confidence intervals for individual means. These estimate the precision of each individual mean but may not align with the multiple comparison results. Non-overlapping traditional confidence intervals do not necessarily indicate significant differences in multiple comparison tests.</p></li>
<li><p><strong><code>1se</code></strong> and <strong><code>2se</code></strong>: Intervals of ±1 or ±2 standard errors around each mean.</p></li>
</ul><p>By default, the function displays regular confidence intervals (<code>int.type = "ci"</code>),
which estimate the precision of individual treatment means. However, when
performing multiple comparisons, these regular confidence intervals may not
align with the letter groupings from Tukey's HSD test. Specifically, you may
observe non-overlapping confidence intervals for treatments that share the
same letter group (indicating no significant difference).</p>
<p>This occurs because regular confidence intervals and Tukey's HSD test serve
different purposes:</p><ul><li><p>Regular confidence intervals estimate individual mean precision</p></li>
<li><p>Tukey's HSD controls the family-wise error rate across all pairwise comparisons</p></li>
</ul><p>To resolve this visual inconsistency, you can use Tukey comparison intervals
(<code>int.type = "tukey"</code>). These intervals are specifically designed for multiple
comparisons and will be consistent with the letter groupings: non-overlapping
Tukey intervals indicate significant differences, while overlapping intervals
suggest no significant difference.</p>
<p>The function will issue a message if it detects potential inconsistencies
between non-overlapping confidence intervals and letter groupings, suggesting
the use of Tukey intervals for clearer interpretation.
For multiple comparison contexts, Tukey comparison intervals are recommended as they provide visual consistency with the statistical test being performed and avoid the common confusion where traditional confidence intervals don't overlap but groups share the same significance letter.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jørgensen, E. &amp; Pedersen, A. R. (1997). How to Obtain Those Nasty
Standard Errors From Transformed Data - and Why They Should Not Be Used. <a href="https://pure.au.dk/portal/en/publications/how-to-obtain-those-nasty-standard-errors-from-transformed-data-a" class="external-link">https://pure.au.dk/portal/en/publications/how-to-obtain-those-nasty-standard-errors-from-transformed-data-a</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Fit aov model</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the ANOVA table for the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Petal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species     2 437.10 218.551  1180.2 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 147  27.22   0.185                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Determine ranking and groups according to Tukey's Test (with Tukey intervals)</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span> <span class="op">&lt;-</span> <span class="fu">multiple_comparisons</span><span class="op">(</span><span class="va">model</span>, classify <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the predicted values table</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species predicted.value std.error  df groups   ci  low   up</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa            1.46      0.06 147      a 0.12 1.34 1.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor            4.26      0.06 147      b 0.12 4.14 4.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica            5.55      0.06 147      c 0.12 5.43 5.67</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show the predicted values plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">pred.out</span>, label_height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multiple_comparisons-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use traditional confidence intervals instead of Tukey comparison intervals</span></span></span>
<span class="r-in"><span><span class="va">pred.out.ci</span> <span class="op">&lt;-</span> <span class="fu">multiple_comparisons</span><span class="op">(</span><span class="va">model</span>, classify <span class="op">=</span> <span class="st">"Species"</span>, int.type <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred.out.ci</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species predicted.value std.error  df groups   ci  low   up</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa            1.46      0.06 147      a 0.12 1.34 1.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor            4.26      0.06 147      b 0.12 4.14 4.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica            5.55      0.06 147      c 0.12 5.43 5.67</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AOV model example with transformation</span></span></span>
<span class="r-in"><span><span class="va">my_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span></span></span>
<span class="r-in"><span><span class="va">my_iris</span><span class="op">$</span><span class="va">Petal.Length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">my_iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span> <span class="co"># Create exponential response</span></span></span>
<span class="r-in"><span><span class="va">exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">my_iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="resplot.html">resplot</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span> <span class="co"># Residual plot shows problems</span></span></span>
<span class="r-plt img"><img src="multiple_comparisons-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a new model using a log transformation of the response</span></span></span>
<span class="r-in"><span><span class="va">log_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">my_iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="resplot.html">resplot</a></span><span class="op">(</span><span class="va">log_model</span><span class="op">)</span> <span class="co"># Looks much better</span></span></span>
<span class="r-plt img"><img src="multiple_comparisons-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the ANOVA table for the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">log_model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: log(Petal.Length)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species     2 437.10 218.551  1180.2 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 147  27.22   0.185                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Back transform, because the "original" data was exponential</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span> <span class="op">&lt;-</span> <span class="fu">multiple_comparisons</span><span class="op">(</span><span class="va">log_model</span>, classify <span class="op">=</span> <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>                                   trans <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Offset value assumed to be 0. Change with `offset` argument.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the predicted values table</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species predicted.value std.error  df groups   ci PredictedValue ApproxSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa            1.46      0.06 147      a 0.12           4.31     0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor            4.26      0.06 147      b 0.12          70.81     4.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica            5.55      0.06 147      c 0.12         257.75    15.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      low     up</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   3.83   4.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  62.79  79.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 228.54 290.69</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show the predicted values plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">pred.out</span>, label_height <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multiple_comparisons-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># ASReml-R Example</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Fit ASReml Model</span></span></span>
<span class="r-in"><span><span class="va">model.asr</span> <span class="op">&lt;-</span> <span class="fu">asreml</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">Nitrogen</span> <span class="op">+</span> <span class="va">Variety</span> <span class="op">+</span> <span class="va">Nitrogen</span><span class="op">:</span><span class="va">Variety</span>,</span></span>
<span class="r-in"><span>                    random <span class="op">=</span> <span class="op">~</span> <span class="va">Blocks</span> <span class="op">+</span> <span class="va">Blocks</span><span class="op">:</span><span class="va">Wplots</span>,</span></span>
<span class="r-in"><span>                    residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span>,</span></span>
<span class="r-in"><span>                    data <span class="op">=</span> <span class="fu">asreml</span><span class="fu">::</span><span class="va">oats</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">wald</span><span class="op">(</span><span class="va">model.asr</span><span class="op">)</span> <span class="co"># Nitrogen main effect significant</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Determine ranking and groups according to Tukey's Test</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span> <span class="op">&lt;-</span> <span class="fu">multiple_comparisons</span><span class="op">(</span>model.obj <span class="op">=</span> <span class="va">model.asr</span>, classify <span class="op">=</span> <span class="st">"Nitrogen"</span>,</span></span>
<span class="r-in"><span>                    descending <span class="op">=</span> <span class="cn">TRUE</span>, decimals <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pred.out</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using a box-cox transformation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span> <span class="co"># See the seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">resp</span>, <span class="va">trt</span>, <span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change one treatment random values to get significant difference</span></span></span>
<span class="r-in"><span><span class="va">ex_data</span><span class="op">$</span><span class="va">resp</span><span class="op">[</span><span class="va">ex_data</span><span class="op">$</span><span class="va">trt</span><span class="op">==</span><span class="st">"A"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model.asr</span> <span class="op">&lt;-</span> <span class="fu">asreml</span><span class="op">(</span><span class="va">resp</span> <span class="op">~</span> <span class="va">trt</span>,</span></span>
<span class="r-in"><span>                    random <span class="op">=</span> <span class="op">~</span> <span class="va">block</span>,</span></span>
<span class="r-in"><span>                    residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span>,</span></span>
<span class="r-in"><span>                    data <span class="op">=</span> <span class="va">ex_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="resplot.html">resplot</a></span><span class="op">(</span><span class="va">model.asr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform Box-Cox transformation and get maximum value</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html" class="external-link">boxcox</a></span><span class="op">(</span><span class="va">ex_data</span><span class="op">$</span><span class="va">resp</span><span class="op">~</span><span class="va">ex_data</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span> <span class="co"># 0.3838</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit cube root to the data</span></span></span>
<span class="r-in"><span><span class="va">model.asr</span> <span class="op">&lt;-</span> <span class="fu">asreml</span><span class="op">(</span><span class="va">resp</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">trt</span>,</span></span>
<span class="r-in"><span>                    random <span class="op">=</span> <span class="op">~</span> <span class="va">block</span>,</span></span>
<span class="r-in"><span>                    residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span>,</span></span>
<span class="r-in"><span>                    data <span class="op">=</span> <span class="va">ex_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="resplot.html">resplot</a></span><span class="op">(</span><span class="va">model.asr</span><span class="op">)</span> <span class="co"># residual plots look much better</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Determine ranking and groups according to Tukey's Test</span></span></span>
<span class="r-in"><span><span class="va">pred.out</span> <span class="op">&lt;-</span> <span class="fu">multiple_comparisons</span><span class="op">(</span>model.obj <span class="op">=</span> <span class="va">model.asr</span>,</span></span>
<span class="r-in"><span>                                 classify <span class="op">=</span> <span class="st">"trt"</span>,</span></span>
<span class="r-in"><span>                                 trans <span class="op">=</span> <span class="st">"power"</span>, power <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pred.out</span></span></span>
<span class="r-in"><span><span class="fu"><a href="autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">pred.out</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sharon Nielsen, Sam Rogers, Annie Conway, University of Adelaide, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

