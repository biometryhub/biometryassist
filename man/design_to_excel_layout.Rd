% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/export_excel.R
\name{design_to_excel_layout}
\alias{design_to_excel_layout}
\title{Create Excel Layout from Experimental Design}
\usage{
design_to_excel_layout(
  design_df,
  value_column = "treatments",
  filename = NULL,
  export_excel = FALSE,
  palette = "default"
)
}
\arguments{
\item{design_df}{A dataframe containing experimental design with 'row' and 'col' columns}

\item{value_column}{Character string specifying which column to use for layout values (default: "treatments")}

\item{filename}{Character string for Excel filename (optional, if provided will export to Excel)}

\item{export_excel}{Logical, whether to export to Excel (default: FALSE)}

\item{palette}{colour palette for Excel export. Can be a palette name (e.g., "default", "spectral", "viridis")
or a vector of custom colours. Only used when exporting to Excel. (default: "default")}
}
\value{
A dataframe representing the spatial layout, or invisibly returns layout if exporting to Excel
}
\description{
Converts an experimental design dataframe into a spatial layout matrix
and optionally exports to Excel format with colour coding.
}
\details{
This function takes an experimental design in long format (with row/col coordinates)
and converts it to a matrix layout that matches the spatial arrangement of the experiment.

If export_excel is TRUE or filename is provided, the function will attempt to export
to Excel format with colour coding based on the specified palette. This requires the
'openxlsx' package to be installed.
}
\examples{
\dontrun{
# Create layout matrix only
layout <- design_to_excel_layout(my_design, "treatments")

# Export to Excel with default colours
design_to_excel_layout(my_design, "treatments",
                       filename = "my_design.xlsx", export_excel = TRUE)

# Export to Excel with viridis palette
design_to_excel_layout(my_design, "treatments",
                       filename = "my_design.xlsx", export_excel = TRUE,
                       palette = "viridis")

# Export with custom colours
design_to_excel_layout(my_design, "treatments",
                       filename = "my_design.xlsx", export_excel = TRUE,
                       palette = c("#FF0000", "#00FF00", "#0000FF"))
}

}
