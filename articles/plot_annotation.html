<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adding Orientation Arrows and Annotations to Field Layout Plots • biometryassist</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adding Orientation Arrows and Annotations to Field Layout Plots">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-971LPN0BS4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-971LPN0BS4');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biometryassist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/installing-asreml-r.html">Installing ASReml-R</a></li>
    <li><a class="dropdown-item" href="../articles/plot_annotation.html">Adding Orientation Arrows and Annotations to Field Layout Plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biometryhub/biometryassist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Adding Orientation Arrows and Annotations to Field Layout Plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biometryhub/biometryassist/blob/main/vignettes/plot_annotation.Rmd" class="external-link"><code>vignettes/plot_annotation.Rmd</code></a></small>
      <div class="d-none name"><code>plot_annotation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When presenting field trial layouts, it’s often important to provide
spatial context through orientation arrows (indicating north or other
directions) and annotations that reference physical features of the
field (such as boundaries, gates, or adjacent landmarks). This vignette
demonstrates how to add these elements to field layout plots generated
by the <code>biometryassist</code> package.</p>
<p>The <code>biometryassist</code> package generates field layout plots
as <code>ggplot2</code> objects, which means we can enhance them using
standard <code>ggplot2</code> functions and extensions. This vignette
will show you how to:</p>
<ol style="list-style-type: decimal">
<li>Add orientation arrows with arbitrary rotation</li>
<li>Add text annotations outside the plotting area to label field
features</li>
</ol>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First, let’s load the required packages and generate a basic
experimental design:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(biometryassist)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Generate a completely randomized design (CRD)</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>des.out <span class="ot">&lt;-</span> <span class="fu">design</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"crd"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">treatments =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">reps =</span> <span class="dv">5</span>, </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">nrows =</span> <span class="dv">4</span>, </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">ncols =</span> <span class="dv">5</span>, </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>Source of Variation                     df</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="sc">==</span><span class="er">===========================================</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>treatments                              <span class="dv">3</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>Residual                                <span class="dv">16</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="sc">==</span><span class="er">===========================================</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>Total                                   <span class="dv">19</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/setup-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># View the basic plot</span></span>
<span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/setup-2.png" class="r-plt" alt="" width="672"></p>
<p>The <code><a href="../reference/design.html">design()</a></code> function creates a field layout and stores
it in <code>des.out$plot.des</code> as a <code>ggplot2</code> object. We
can now enhance this plot with additional annotations.</p>
</div>
<div class="section level2">
<h2 id="adding-an-orientation-arrow">Adding an Orientation Arrow<a class="anchor" aria-label="anchor" href="#adding-an-orientation-arrow"></a>
</h2>
<p>Orientation arrows help readers understand the spatial layout of a
field trial relative to cardinal directions or other reference points.
This is particularly useful when field orientation affects environmental
conditions like sun exposure or prevailing winds.</p>
<div class="section level3">
<h3 id="using-ggspatial-for-north-arrows">Using ggspatial for North Arrows<a class="anchor" aria-label="anchor" href="#using-ggspatial-for-north-arrows"></a>
</h3>
<p>The <code>ggspatial</code> package provides the
<code>annotation_north_arrow()</code> function, which is specifically
designed for adding directional arrows to plots. While it’s primarily
intended for spatial data with coordinate reference systems, it works
well for field layout plots too.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotation_north_arrow</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"tr"</span>,</span>
<span>    rotation <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    pad_x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu">north_arrow_fancy_orienteering</span><span class="op">(</span></span>
<span>      line_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      text_size <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">50</span>, b <span class="op">=</span> <span class="fl">10</span>, l <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/north_arrow-1.png" class="r-plt" alt="" width="672"></p>
<p>Let’s break down each component of this code:</p>
<p><strong><code>annotation_north_arrow()</code> arguments:</strong></p>
<ul>
<li><p><code>location = "tr"</code>: Places the arrow in the top-right
corner. Other options include <code>"tl"</code> (top-left),
<code>"bl"</code> (bottom-left), <code>"br"</code> (bottom-right), or
you can specify exact coordinates as a numeric vector
<code>c(x, y)</code>.</p></li>
<li><p><code>rotation = 45</code>: Rotates the arrow 45 degrees
clockwise from north. This allows you to indicate the true field
orientation. For example, if north in your field is 45 degrees clockwise
from the top of your plot, use <code>rotation = 45</code>. Use
<code>rotation = 0</code> if north aligns with the top of the
plot.</p></li>
<li><p><code>pad_x = unit(-1.5, "cm")</code>: Moves the arrow
horizontally. Negative values move it left, positive values move it
right. This allows fine-tuning of the arrow position.</p></li>
<li><p><code>pad_y = unit(0.5, "cm")</code>: Moves the arrow vertically.
Positive values move it up, negative values move it down.</p></li>
<li>
<p><code>style = north_arrow_fancy_orienteering()</code>: Specifies
the visual style of the arrow. Other available styles include:</p>
<ul>
<li>
<code>north_arrow_minimal()</code>: Simple arrow design</li>
<li>
<code>north_arrow_nautical()</code>: Compass-style design</li>
<li>
<code>north_arrow_orienteering()</code>: Classic orienteering map
style</li>
</ul>
<p>Within each style function, you can customize:</p>
<ul>
<li>
<code>line_width</code>: Thickness of arrow lines</li>
<li>
<code>text_size</code>: Size of the “N” label</li>
</ul>
</li>
</ul>
<p><strong>Additional ggplot2 modifications:</strong></p>
<ul>
<li><p><code>coord_cartesian(clip = "off")</code>: This is
<strong>critical</strong>. By default, ggplot2 clips (cuts off) any
elements that fall outside the plotting area. Setting
<code>clip = "off"</code> allows the arrow to be drawn outside the plot
panel, which is necessary when using padding to position it beyond the
plot boundaries.</p></li>
<li><p><code>theme(plot.margin = ...)</code>: Expands the margins around
the plot to create space for the arrow. The <code>margin()</code>
function takes four values: top, right, bottom, left. Units are
specified with the <code>unit</code> parameter (here, points). We
increase the right margin to <code>50pt</code> to accommodate the
arrow.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="customizing-arrow-appearance">Customizing Arrow Appearance<a class="anchor" aria-label="anchor" href="#customizing-arrow-appearance"></a>
</h3>
<p>You can customize the arrow style parameters to match your needs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotation_north_arrow</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"tr"</span>,</span>
<span>    rotation <span class="op">=</span> <span class="fl">30</span>,  <span class="co"># Different rotation angle</span></span>
<span>    pad_x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu">north_arrow_minimal</span><span class="op">(</span>  <span class="co"># Different style</span></span>
<span>      line_width <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>      text_size <span class="op">=</span> <span class="fl">12</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">50</span>, b <span class="op">=</span> <span class="fl">10</span>, l <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="adding-field-feature-annotations">Adding Field Feature Annotations<a class="anchor" aria-label="anchor" href="#adding-field-feature-annotations"></a>
</h2>
<p>In addition to orientation, it’s often helpful to label physical
features of the field site, such as boundaries, access points, or
adjacent landmarks. These annotations provide practical context for
field operations and help with trial management.</p>
<div class="section level3">
<h3 id="using-annotate-for-text-labels">Using annotate() for Text Labels<a class="anchor" aria-label="anchor" href="#using-annotate-for-text-labels"></a>
</h3>
<p>The <code>annotate()</code> function allows us to add text (and other
geometric objects) to specific locations on the plot. Unlike the north
arrow, these annotations use the plot’s coordinate system.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">5.8</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Boundary Road"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">270</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Gate"</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">70</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/field_annotations-1.png" class="r-plt" alt="" width="672"></p>
<p>Let’s examine each annotation in detail:</p>
<p><strong>First annotation - “Boundary Road” (vertical text on
right):</strong></p>
<ul>
<li><p><code>"text"</code>: Specifies that we’re adding a text
annotation (other options include <code>"rect"</code>,
<code>"segment"</code>, etc.)</p></li>
<li><p><code>x = 5.8</code>: The x-coordinate for the text. Since our
plot has 5 columns (numbered 1-5), placing it at 5.8 positions it
outside the right edge of the plot.</p></li>
<li><p><code>y = mean(des.out$design$row)</code>: Centers the text
vertically by calculating the mean of all row numbers. This ensures the
text is centered regardless of the number of rows.</p></li>
<li><p><code>label = "Boundary Road"</code>: The text to
display.</p></li>
<li><p><code>angle = 270</code>: Rotates the text 270 degrees (or -90
degrees), making it read from bottom to top. This is conventional for
labels on the right side of plots.</p></li>
<li><p><code>hjust = 0.5</code>: Horizontal justification. 0.5 centers
the text horizontally relative to the x-coordinate.</p></li>
<li><p><code>vjust = -0.5</code>: Vertical justification. Negative
values move the text away from the plot (outward), while positive values
would move it toward the plot. This ensures the text doesn’t overlap
with the plot area.</p></li>
<li><p><code>size = 6</code>: The font size for the text.</p></li>
</ul>
<p><strong>Second annotation - “Gate” (horizontal text on
top):</strong></p>
<ul>
<li><p><code>x = 1.5</code>: Positions the text above column 1.5
(between columns 1 and 2).</p></li>
<li><p><code>y = 5</code>: Places it above the top row (row 4), outside
the plotting area.</p></li>
<li><p><code>angle</code> is not specified, so the text remains
horizontal (0 degrees).</p></li>
<li><p>Other parameters work similarly to the first annotation.</p></li>
</ul>
<p><strong>Critical settings for external annotations:</strong></p>
<ul>
<li>
<code>coord_cartesian(xlim = c(0.5, 5.5), ylim = c(0.5, 4.5), clip = "off")</code>:
<ul>
<li>
<code>xlim</code> and <code>ylim</code> explicitly set the visible
data range. This is <strong>essential</strong> because when we add
annotations with coordinates outside the data range (like x = 5.8),
ggplot2 would normally expand the axis limits to include these points,
stretching the plot. By explicitly setting the limits to match our
original plot grid (columns 0.5-5.5, rows 0.5-4.5), we prevent this
expansion.</li>
<li>
<code>clip = "off"</code> allows drawing outside these limits, so
our annotations at x = 5.8 and y = 5 are still visible.</li>
</ul>
</li>
<li>
<code>theme(plot.margin = ...)</code>: Expands margins to create
physical space for the text. The right margin is set to
<code>70pt</code> to accommodate “Boundary Road”, and the top margin is
<code>20pt</code> for “Gate”.</li>
</ul>
</div>
<div class="section level3">
<h3 id="understanding-the-coordinate-system">Understanding the Coordinate System<a class="anchor" aria-label="anchor" href="#understanding-the-coordinate-system"></a>
</h3>
<p>The field layout plot uses the row and column numbers as coordinates:
- Columns are numbered 1 to <code>ncols</code> (here, 1 to 5) - Rows are
numbered 1 to <code>nrows</code> (here, 1 to 4) - Each plot cell is
centered on its integer coordinates</p>
<p>To position annotations: - <strong>Outside right edge</strong>: Use x
&gt; max column number (e.g., x = 5.8 when max column is 5) -
<strong>Outside top edge</strong>: Use y &gt; max row number (e.g., y =
5 when max row is 4) - <strong>Outside left edge</strong>: Use x &lt;
min column number (e.g., x = 0.2 when min column is 1) - <strong>Outside
bottom edge</strong>: Use y &lt; min row number (e.g., y = 0.2 when min
row is 1)</p>
</div>
<div class="section level3">
<h3 id="adding-multiple-features">Adding Multiple Features<a class="anchor" aria-label="anchor" href="#adding-multiple-features"></a>
</h3>
<p>You can add as many annotations as needed by chaining multiple
<code>annotate()</code> calls:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.8</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Boundary Road"</span>, angle <span class="op">=</span> <span class="fl">270</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">5</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Gate"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Irrigation Line"</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">col</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Drainage Ditch"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">20</span>, r <span class="op">=</span> <span class="fl">70</span>, b <span class="op">=</span> <span class="fl">30</span>, l <span class="op">=</span> <span class="fl">50</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/multiple_annotations-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="combining-orientation-arrows-and-annotations">Combining Orientation Arrows and Annotations<a class="anchor" aria-label="anchor" href="#combining-orientation-arrows-and-annotations"></a>
</h2>
<p>You can combine both techniques to create a fully annotated field
layout:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des.out</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span> </span>
<span>  <span class="co"># Add north arrow</span></span>
<span>  <span class="fu">annotation_north_arrow</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"tr"</span>,</span>
<span>    rotation <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    pad_x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu">north_arrow_fancy_orienteering</span><span class="op">(</span>line_width <span class="op">=</span> <span class="fl">1</span>, text_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add field feature annotations</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.8</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Boundary Road"</span>, angle <span class="op">=</span> <span class="fl">270</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">5</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Gate"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Apply coordinate system and theme adjustments</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">20</span>, r <span class="op">=</span> <span class="fl">70</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/combined_example-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="tips-and-best-practices">Tips and Best Practices<a class="anchor" aria-label="anchor" href="#tips-and-best-practices"></a>
</h2>
<div class="section level3">
<h3 id="determining-appropriate-coordinates">Determining Appropriate Coordinates<a class="anchor" aria-label="anchor" href="#determining-appropriate-coordinates"></a>
</h3>
<p>To find the right coordinates for your annotations:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Check the design dimensions</strong>: Use
<code>str(des.out$design)</code> to see the row and column ranges</li>
<li>
<strong>Use summary functions</strong>: <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>,
<code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code>, and <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code> help center or position
annotations</li>
<li>
<strong>Experiment iteratively</strong>: Start with approximate
values and adjust based on the output</li>
</ol>
</div>
<div class="section level3">
<h3 id="adjusting-margins">Adjusting Margins<a class="anchor" aria-label="anchor" href="#adjusting-margins"></a>
</h3>
<p>If your annotations are cut off or too far from the plot:</p>
<ul>
<li>
<strong>Increase margin</strong> if text is cut off:
<code>margin(t = 30, r = 80, ...)</code>
</li>
<li>
<strong>Decrease margin</strong> if there’s too much white space:
<code>margin(t = 10, r = 40, ...)</code>
</li>
<li>Margins are specified as: top, right, bottom, left</li>
</ul>
</div>
<div class="section level3">
<h3 id="text-rotation-guidelines">Text Rotation Guidelines<a class="anchor" aria-label="anchor" href="#text-rotation-guidelines"></a>
</h3>
<ul>
<li>
<code>angle = 0</code>: Horizontal text (default)</li>
<li>
<code>angle = 90</code>: Vertical text, reading bottom-to-top</li>
<li>
<code>angle = 270</code> or <code>angle = -90</code>: Vertical text,
reading top-to-bottom (conventional for right-side labels)</li>
<li>
<code>angle = 45</code>: Diagonal text (sometimes useful for corner
annotations)</li>
</ul>
</div>
<div class="section level3">
<h3 id="justification-parameters">Justification Parameters<a class="anchor" aria-label="anchor" href="#justification-parameters"></a>
</h3>
<ul>
<li>
<code>hjust = 0</code>: Left-aligned</li>
<li>
<code>hjust = 0.5</code>: Center-aligned (most common)</li>
<li>
<code>hjust = 1</code>: Right-aligned</li>
<li>
<code>vjust = 0</code>: Bottom-aligned</li>
<li>
<code>vjust = 0.5</code>: Middle-aligned</li>
<li>
<code>vjust = 1</code>: Top-aligned</li>
</ul>
<p>For external annotations, <code>vjust</code> values outside 0-1 (like
<code>vjust = -0.5</code>) create spacing between the text and the plot
edge.</p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-different-design-types">Working with Different Design Types<a class="anchor" aria-label="anchor" href="#working-with-different-design-types"></a>
</h2>
<p>These techniques work with any design type generated by
<code>biometryassist</code>. Here’s an example with a randomized
complete block design (RCBD):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Generate an RCBD</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>des.rcbd <span class="ot">&lt;-</span> <span class="fu">design</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"rcbd"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">treatments =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">reps =</span> <span class="dv">4</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">nrows =</span> <span class="dv">6</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">ncols =</span> <span class="dv">4</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="at">brows =</span> <span class="dv">6</span>,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="at">bcols =</span> <span class="dv">1</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>Source of Variation                     df</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="sc">==</span><span class="er">===========================================</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>Block stratum                           <span class="dv">3</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="sc">---------------------------------------------</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>treatments                              <span class="dv">5</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>Residual                                <span class="dv">15</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="sc">==</span><span class="er">===========================================</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>Total                                   <span class="dv">23</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/rcbd_example-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Add annotations</span></span>
<span><span class="va">des.rcbd</span><span class="op">$</span><span class="va">plot.des</span> <span class="op">+</span></span>
<span>  <span class="fu">annotation_north_arrow</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"tr"</span>,</span>
<span>    rotation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pad_x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu">north_arrow_minimal</span><span class="op">(</span>line_width <span class="op">=</span> <span class="fl">1</span>, text_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4.8</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">des.rcbd</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"Access Road"</span>, angle <span class="op">=</span> <span class="fl">270</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">60</span>, b <span class="op">=</span> <span class="fl">10</span>, l <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_annotation_files/figure-html/rcbd_example-2.png" class="r-plt" alt="" width="672"></p>
<p>Note how the coordinate limits (<code>xlim</code> and
<code>ylim</code>) are adjusted to match the dimensions of this design
(4 columns, 6 rows).</p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="problem-annotation-is-cut-off">Problem: Annotation is cut off<a class="anchor" aria-label="anchor" href="#problem-annotation-is-cut-off"></a>
</h3>
<p><strong>Solution</strong>: Increase the relevant plot margin using
<code>theme(plot.margin = margin(...))</code>. Ensure margins are large
enough to accommodate your text.</p>
</div>
<div class="section level3">
<h3 id="problem-plot-is-stretched-or-distorted">Problem: Plot is stretched or distorted<a class="anchor" aria-label="anchor" href="#problem-plot-is-stretched-or-distorted"></a>
</h3>
<p><strong>Solution</strong>: When using <code>annotate()</code> with
coordinates outside the plot range, always specify explicit limits in
<code>coord_cartesian(xlim = ..., ylim = ...)</code> to prevent
automatic axis expansion.</p>
</div>
<div class="section level3">
<h3 id="problem-north-arrow-is-not-visible">Problem: North arrow is not visible<a class="anchor" aria-label="anchor" href="#problem-north-arrow-is-not-visible"></a>
</h3>
<p><strong>Solution</strong>: 1. Check that
<code>coord_cartesian(clip = "off")</code> is included 2. Verify that
plot margins are large enough 3. Adjust <code>pad_x</code> and
<code>pad_y</code> values to position the arrow within the margin
area</p>
</div>
<div class="section level3">
<h3 id="problem-text-orientation-is-wrong">Problem: Text orientation is wrong<a class="anchor" aria-label="anchor" href="#problem-text-orientation-is-wrong"></a>
</h3>
<p><strong>Solution</strong>: Adjust the <code>angle</code> parameter: -
For right side labels reading upward: <code>angle = 90</code> - For
right side labels reading downward (conventional):
<code>angle = 270</code> - For left side labels: reverse these
angles</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Adding orientation arrows and field feature annotations to your
experimental design plots enhances their utility for field management,
reporting, and publication. The combination of
<code><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_north_arrow.html" class="external-link">ggspatial::annotation_north_arrow()</a></code> for directional
reference and <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">ggplot2::annotate()</a></code> for custom labels
provides flexible tools for creating publication-ready field layout
diagrams.</p>
<p>Remember the key principles: - Use
<code>coord_cartesian(clip = "off")</code> to allow drawing outside the
plot panel - Set appropriate <code>plot.margin</code> values to create
space for external elements - For <code>annotate()</code>, explicitly
set <code>xlim</code> and <code>ylim</code> to prevent axis stretching -
Experiment with positioning and adjust iteratively</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ul>
<li><a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2
documentation</a></li>
<li><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial package
documentation</a></li>
<li>biometryassist package vignettes for experimental design
options</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sharon Nielsen, Sam Rogers, Annie Conway, University of Adelaide, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
